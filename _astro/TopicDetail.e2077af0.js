import{p as w,h as d,_ as N,F as $}from"./hooks.module.9ee1d4a4.js";import{C as _}from"./close.3a539829.js";import{S as D}from"./spinner.164b1eeb.js";import{a as A}from"./http.1ee0e3a2.js";import{i as M}from"./jwt.2bcbdb7f.js";import{g as G,u as R,r as U,i as O}from"./resource-progress.d33f2209.js";import{p as P,s as z}from"./page.d4f83d9f.js";import{o as e}from"./jsxRuntime.module.8b00cb04.js";import{k as B}from"./preact.module.f1575aff.js";function x(c,t,n=[]){w(()=>{const o=i=>{i.key.toLowerCase()===c.toLowerCase()&&t()};return window.addEventListener("keydown",o),()=>{window.removeEventListener("keydown",o)}},n)}function F(c){w(()=>{function t(n){const{resourceType:o,resourceId:i,topicId:u}=n.detail;c({resourceType:o,resourceId:i,topicId:u})}return window.addEventListener("roadmap.topic.click",t),window.addEventListener("best-practice.topic.click",t),()=>{window.removeEventListener("roadmap.topic.click",t),window.removeEventListener("best-practice.topic.click",t)}},[])}function H(c,t){w(()=>{const n=o=>{!c?.current?.contains(o.target)&&t()};return document.addEventListener("mousedown",n),document.addEventListener("touchstart",n),()=>{document.removeEventListener("mousedown",n),document.removeEventListener("touchstart",n)}},[c])}function K(c){w(()=>{function t(n){const{resourceType:o,resourceId:i,topicId:u}=n.detail;c({resourceType:o,resourceId:i,topicId:u})}return window.addEventListener("best-practice.topic.toggle",t),()=>{window.removeEventListener("best-practice.topic.toggle",t)}},[])}const J="/_astro/down.93d0ce97.svg",b={done:"bg-green-500",learning:"bg-yellow-500",pending:"bg-gray-300",skipped:"bg-black"};function Q(c){const{topicId:t,resourceId:n,resourceType:o,onClose:i,onShowLoginPopup:u}=c,[v,g]=d(!0),[s,h]=d("pending"),[L,y]=d(!1),f=N(null);H(f,()=>{y(!1)});const C=$(()=>!M(),[]);w(()=>{!t||!n||!o||(g(!0),G({topicId:t,resourceId:n,resourceType:o}).then(r=>{g(!1),h(r)}).catch(console.error))},[t,n,o]),x("d",()=>{if(s==="done"){i();return}l("done")},[s]),x("l",()=>{if(s==="learning"){i();return}l("learning")},[s]),x("s",()=>{if(s==="skipped"){i();return}l("skipped")},[s]),x("r",()=>{if(console.log(s),s==="pending"){i();return}l("pending")},[s]);const l=r=>{if(C){i(),u();return}g(!0),R({topicId:t,resourceId:n,resourceType:o},r).then(()=>{h(r),i(),U(t,r)}).catch(a=>{alert(a.message),console.error(a)}).finally(()=>{g(!1)})},T=["pending","learning","done"].includes(s),k=["skipped","pending","learning"].includes(s),E=["done","skipped","pending"].includes(s),I=["skipped","done","learning"].includes(s);return v?e("button",{className:"inline-flex cursor-default items-center rounded-md border border-gray-300 bg-white p-1 px-2 text-sm text-black",children:[e("img",{alt:"Check",class:"h-4 w-4 animate-spin",src:D}),e("span",{className:"ml-2",children:"Updating Status.."})]}):e("div",{className:"relative inline-flex rounded-md border border-gray-300",children:[e("span",{className:"inline-flex cursor-default items-center  p-1 px-2 text-sm text-black",children:[e("span",{class:"flex h-2 w-2",children:e("span",{class:`relative inline-flex h-2 w-2 rounded-full ${b[s]}`})}),e("span",{className:"ml-2 capitalize",children:s==="learning"?"In Progress":s})]}),e("button",{className:"inline-flex cursor-pointer items-center rounded-br-md rounded-tr-md border-l border-l-gray-300 bg-gray-100 p-1 px-2 text-sm text-black hover:bg-gray-200",onClick:()=>y(!0),children:[e("span",{className:"mr-0.5",children:"Update Status"}),e("img",{alt:"Check",class:"h-4 w-4",src:J})]}),L&&e("div",{className:"absolute right-0 top-full mt-1 flex min-w-[160px] flex-col divide-y rounded-md border border-gray-200 bg-white shadow-md [&>button:first-child]:rounded-t-md [&>button:last-child]:rounded-b-md",ref:f,children:[k&&e("button",{class:"inline-flex justify-between px-3 py-1.5 text-left text-sm text-gray-800 hover:bg-gray-100",onClick:()=>l("done"),children:[e("span",{children:[e("span",{class:`mr-2 inline-block h-2 w-2 rounded-full ${b.done}`}),"Done"]}),e("span",{class:"text-xs text-gray-500",children:"D"})]}),E&&e("button",{class:"inline-flex justify-between px-3 py-1.5 text-left text-sm text-gray-800 hover:bg-gray-100",onClick:()=>l("learning"),children:[e("span",{children:[e("span",{class:`mr-2 inline-block h-2 w-2 rounded-full ${b.learning}`}),"In Progress"]}),e("span",{class:"text-xs text-gray-500",children:"L"})]}),I&&e("button",{class:"inline-flex justify-between px-3 py-1.5 text-left text-sm text-gray-800 hover:bg-gray-100",onClick:()=>l("pending"),children:[e("span",{children:[e("span",{class:`mr-2 inline-block h-2 w-2 rounded-full ${b.pending}`}),"Reset"]}),e("span",{class:"text-xs text-gray-500",children:"R"})]}),T&&e("button",{class:"inline-flex justify-between px-3 py-1.5 text-left text-sm text-gray-800 hover:bg-gray-100",onClick:()=>l("skipped"),children:[e("span",{children:[e("span",{class:`mr-2 inline-block h-2 w-2 rounded-full ${b.skipped}`}),"Skip"]}),e("span",{class:"text-xs text-gray-500",children:"S"})]})]})]})}function oe(){const[c,t]=d(!1),[n,o]=d(!1),[i,u]=d(""),[v,g]=d(""),s=$(()=>!M(),[]),h=N(null),[L,y]=d(""),[f,C]=d(""),[l,T]=d("roadmap"),k=()=>{const r=document.querySelector("#login-popup");if(!r)return;r.classList.remove("hidden"),r.classList.add("flex");const a=r.querySelector("[autofocus]");a&&a.focus()};if(H(h,()=>{t(!1)}),x("Escape",()=>{t(!1)}),K(({topicId:r,resourceType:a,resourceId:m})=>{if(s){k();return}P.set("Updating"),O({topicId:r,resourceId:m,resourceType:a}).then(p=>R({topicId:r,resourceId:m,resourceType:a},p?"pending":"done")).then(({done:p=[]})=>{U(r,p.includes(r)?"done":"pending")}).catch(p=>{alert(p.message),console.error(p)}).finally(()=>{P.set("")})}),F(({topicId:r,resourceType:a,resourceId:m})=>{o(!0),t(!0),z.set(!0),y(r),T(a),C(m);const p=r.replaceAll(":","/"),q=a==="roadmap"?`/${m}/${p}`:`/best-practices/${m}/${p}`;A(q,{},{headers:{Accept:"text/html"}}).then(({response:S})=>{if(!S){u("Topic not found.");return}const j=new DOMParser().parseFromString(S,"text/html")?.getElementById("main-content")?.outerHTML||"";o(!1),g(j)}).catch(S=>{u("Something went wrong. Please try again later."),o(!1)})}),!c)return null;const I=`https://github.com/kamranahmedse/developer-roadmap/tree/master/src/data/${l==="roadmap"?"roadmaps":"best-practices"}/${f}/content`;return e("div",{children:[e("div",{ref:h,className:"fixed right-0 top-0 z-40 h-screen w-full overflow-y-auto bg-white p-4 sm:max-w-[600px] sm:p-6",children:[n&&e("div",{className:"flex w-full justify-center",children:e("img",{src:D,alt:"Loading",className:"h-6 w-6 animate-spin fill-blue-600 text-gray-200 sm:h-12 sm:w-12"})}),!n&&!i&&e(B,{children:[e("div",{className:"mb-2",children:[e(Q,{topicId:L,resourceId:f,resourceType:l,onShowLoginPopup:k,onClose:()=>{t(!1)}}),e("button",{type:"button",id:"close-topic",className:"absolute right-2.5 top-2.5 inline-flex items-center rounded-lg bg-transparent p-1.5 text-sm text-gray-400 hover:bg-gray-200 hover:text-gray-900",onClick:()=>t(!1),children:e("img",{alt:"Close",class:"h-5 w-5",src:_})})]}),e("div",{id:"topic-content",className:"prose prose-quoteless prose-h1:mb-2.5 prose-h1:mt-7 prose-h2:mb-3 prose-h2:mt-0 prose-h3:mb-[5px] prose-h3:mt-[10px] prose-p:mb-2 prose-p:mt-0 prose-blockquote:font-normal prose-blockquote:not-italic prose-blockquote:text-gray-700 prose-li:m-0 prose-li:mb-0.5",dangerouslySetInnerHTML:{__html:v}}),e("p",{id:"contrib-meta",class:"mt-10 border-t pt-3 text-sm leading-relaxed text-gray-400",children:["Contribute links to learning resources about this topic"," ",e("a",{target:"_blank",class:"text-blue-700 underline",href:I,children:"on GitHub repository."}),"."]})]})]}),e("div",{class:"fixed inset-0 z-30 bg-gray-900 bg-opacity-50 dark:bg-opacity-80"})]})}export{oe as TopicDetail};
