import{p as u,h as a,F,_ as M}from"./hooks.module.ee390651.js";import{C as O}from"./close.3a539829.js";import{S as N}from"./spinner.164b1eeb.js";import{a as z}from"./http.1ee0e3a2.js";import{i as G}from"./jwt.2bcbdb7f.js";import{g as j,u as I,r as T,i as K}from"./resource-progress.77080f5b.js";import{p as E,s as J}from"./page.d4f83d9f.js";import{o as e}from"./jsxRuntime.module.760e3403.js";import{_ as P}from"./preact.module.e54f245b.js";const y="/_astro/check.46a63738.svg",S="/_astro/progress.c7872cfb.svg",_="/_astro/reset.c24545cf.svg";function Q(c,t){u(()=>{const n=r=>{r.key.toLowerCase()===c.toLowerCase()&&t()};return window.addEventListener("keydown",n),()=>{window.removeEventListener("keydown",n)}},[])}function V(c){u(()=>{function t(n){const{resourceType:r,resourceId:l,topicId:d}=n.detail;c({resourceType:r,resourceId:l,topicId:d})}return window.addEventListener("roadmap.topic.click",t),window.addEventListener("best-practice.topic.click",t),()=>{window.removeEventListener("roadmap.topic.click",t),window.removeEventListener("best-practice.topic.click",t)}},[])}function W(c,t){u(()=>{const n=r=>{!c?.current?.contains(r.target)&&t()};return document.addEventListener("mousedown",n),document.addEventListener("touchstart",n),()=>{document.removeEventListener("mousedown",n),document.removeEventListener("touchstart",n)}},[c])}function X(c){u(()=>{function t(n){const{resourceType:r,resourceId:l,topicId:d}=n.detail;c({resourceType:r,resourceId:l,topicId:d})}return window.addEventListener("best-practice.topic.toggle",t),()=>{window.removeEventListener("best-practice.topic.toggle",t)}},[])}function ae(){const[c,t]=a(!1),[n,r]=a(!1),[l,d]=a(""),[q,D]=a(""),[w,C]=a("pending"),[h,f]=a(!0),v=F(()=>!G(),[]),L=M(null),[m,H]=a(""),[b,R]=a(""),[x,U]=a("roadmap"),B=()=>{const s=document.querySelector("#login-popup");if(!s)return;s.classList.remove("hidden"),s.classList.add("flex");const o=s.querySelector("[autofocus]");o&&o.focus()},g=s=>{f(!0),I({topicId:m,resourceId:b,resourceType:x},s).then(()=>{C(s),t(!1),T(m,s)}).catch(o=>{alert(o.message),console.error(o)}).finally(()=>{f(!1)})};return u(()=>{!m||!b||!x||(f(!0),j({topicId:m,resourceId:b,resourceType:x}).then(s=>{f(!1),C(s)}).catch(console.error))},[m,b,x]),W(L,()=>{t(!1)}),Q("Escape",()=>{t(!1)}),X(({topicId:s,resourceType:o,resourceId:p})=>{if(v){B();return}E.set("Updating"),K({topicId:s,resourceId:p,resourceType:o}).then(i=>I({topicId:s,resourceId:p,resourceType:o},i?"pending":"done")).then(({done:i=[]})=>{T(s,i.includes(s)?"done":"pending")}).catch(i=>{alert(i.message),console.error(i)}).finally(()=>{E.set("")})}),V(({topicId:s,resourceType:o,resourceId:p})=>{r(!0),t(!0),J.set(!0),H(s),U(o),R(p);const i=s.replaceAll(":","/"),$=o==="roadmap"?`/${p}/${i}`:`/best-practices/${p}/${i}`;z($,{},{headers:{Accept:"text/html"}}).then(({response:k})=>{if(!k){d("Topic not found.");return}const A=new DOMParser().parseFromString(k,"text/html")?.getElementById("main-content")?.outerHTML||"";r(!1),D(A)}).catch(k=>{d("Something went wrong. Please try again later."),r(!1)})}),c?e("div",{children:[e("div",{ref:L,className:"fixed right-0 top-0 z-40 h-screen w-full overflow-y-auto bg-white p-4 sm:max-w-[600px] sm:p-6",children:[n&&e("div",{className:"flex w-full justify-center",children:e("img",{src:N,alt:"Loading",className:"h-6 w-6 animate-spin fill-blue-600 text-gray-200 sm:h-12 sm:w-12"})}),!n&&!l&&e(P,{children:[e("div",{className:"mb-2",children:[v&&e("div",{className:"flex items-center gap-2",children:[e("button",{"data-popup":"login-popup",className:"inline-flex items-center rounded-md bg-green-600 p-1 px-2 text-sm text-white hover:bg-green-700",onClick:()=>t(!1),children:[e("img",{alt:"Check",class:"w-3",src:y}),e("span",{className:"ml-2",children:"Done"})]}),e("button",{"data-popup":"login-popup",className:"inline-flex items-center rounded-md bg-[#dad1fd] p-1 px-2 text-sm text-[#0E033B] hover:bg-[#C4B6FC]",onClick:()=>t(!1),children:[e("img",{alt:"Learning",class:"w-4",src:S}),e("span",{className:"ml-2",children:"In Progress"})]})]}),!v&&e(P,{children:[h&&e("button",{className:"inline-flex cursor-default items-center rounded-md border border-gray-300 bg-white p-1 px-2 text-sm text-black",children:[e("img",{alt:"Check",class:"h-4 w-4 animate-spin",src:N}),e("span",{className:"ml-2",children:"Updating Status.."})]}),!h&&w==="pending"&&e("div",{className:"flex items-center gap-2",children:[e("button",{className:"inline-flex items-center rounded-md border border-green-600 bg-green-600 p-1 px-2 text-sm text-white hover:bg-green-700",onClick:()=>g("done"),children:[e("img",{alt:"Check",class:"w-3",src:y}),e("span",{className:"ml-2",children:"Done"})]}),e("button",{className:"inline-flex items-center rounded-md bg-[#dad1fd] p-1 px-2 text-sm text-[#0E033B] hover:bg-[#C4B6FC]",onClick:()=>g("learning"),children:[e("img",{alt:"Learning",class:"w-4",src:S}),e("span",{className:"ml-2",children:"In Progress"})]})]}),!h&&w==="done"&&e("button",{className:"inline-flex items-center rounded-md border border-red-600 bg-red-600 p-1 px-2 text-sm text-white hover:bg-red-700",onClick:()=>g("pending"),children:[e("img",{alt:"Check",class:"h-4",src:_}),e("span",{className:"ml-2",children:"Pending"})]}),!h&&w==="learning"&&e("div",{className:"flex items-center gap-2",children:[e("button",{className:"inline-flex items-center rounded-md border border-green-600 bg-green-600 p-1 px-2 text-sm text-white hover:bg-green-700",onClick:()=>g("done"),children:[e("img",{alt:"Check",class:"w-3",src:y}),e("span",{className:"ml-2",children:"Done"})]}),e("button",{className:"inline-flex items-center rounded-md border border-red-600 bg-red-600 p-1 px-2 text-sm text-white hover:bg-red-700",onClick:()=>g("pending"),children:[e("img",{alt:"Check",class:"h-4",src:_}),e("span",{className:"ml-2",children:"Pending"})]})]})]}),e("button",{type:"button",id:"close-topic",className:"absolute right-2.5 top-2.5 inline-flex items-center rounded-lg bg-transparent p-1.5 text-sm text-gray-400 hover:bg-gray-200 hover:text-gray-900",onClick:()=>t(!1),children:e("img",{alt:"Close",class:"h-5 w-5",src:O})})]}),e("div",{id:"topic-content",className:"prose prose-quoteless prose-h1:mb-2.5 prose-h1:mt-7 prose-h2:mb-3 prose-h2:mt-0 prose-h3:mb-[5px] prose-h3:mt-[10px] prose-p:mb-2 prose-p:mt-0 prose-blockquote:font-normal prose-blockquote:not-italic prose-blockquote:text-gray-700 prose-li:m-0 prose-li:mb-0.5",dangerouslySetInnerHTML:{__html:q}})]})]}),e("div",{class:"fixed inset-0 z-30 bg-gray-900 bg-opacity-50 dark:bg-opacity-80"})]}):null}export{ae as TopicDetail};
