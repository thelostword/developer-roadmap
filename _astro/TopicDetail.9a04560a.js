import{p as f,h as a,F as N,_ as $}from"./hooks.module.ee390651.js";import{C as q}from"./close.3a539829.js";import{S as E}from"./spinner.164b1eeb.js";import{a as B}from"./http.1ee0e3a2.js";import{i as P}from"./jwt.2bcbdb7f.js";import{g as R,u as D,r as S,i as A}from"./resource-progress.77080f5b.js";import{p as C,s as F}from"./page.d4f83d9f.js";import{o as e}from"./jsxRuntime.module.760e3403.js";import{_ as G}from"./preact.module.e54f245b.js";function O(o,t){f(()=>{const s=n=>{n.key.toLowerCase()===o.toLowerCase()&&t()};return window.addEventListener("keydown",s),()=>{window.removeEventListener("keydown",s)}},[])}function z(o){f(()=>{function t(s){const{resourceType:n,resourceId:i,topicId:l}=s.detail;o({resourceType:n,resourceId:i,topicId:l})}return window.addEventListener("roadmap.topic.click",t),window.addEventListener("best-practice.topic.click",t),()=>{window.removeEventListener("roadmap.topic.click",t),window.removeEventListener("best-practice.topic.click",t)}},[])}function j(o,t){f(()=>{const s=n=>{!o?.current?.contains(n.target)&&t()};return document.addEventListener("mousedown",s),document.addEventListener("touchstart",s),()=>{document.removeEventListener("mousedown",s),document.removeEventListener("touchstart",s)}},[o])}function K(o){f(()=>{function t(s){const{resourceType:n,resourceId:i,topicId:l}=s.detail;o({resourceType:n,resourceId:i,topicId:l})}return window.addEventListener("best-practice.topic.toggle",t),()=>{window.removeEventListener("best-practice.topic.toggle",t)}},[])}const I="/_astro/check.46a63738.svg",T="/_astro/progress.c7872cfb.svg",J="/_astro/reset.c24545cf.svg";function Q(o){const{topicId:t,resourceId:s,resourceType:n,onClose:i}=o,[l,m]=a(!0),[g,b]=a("pending"),w=N(()=>!P(),[]);f(()=>{!t||!s||!n||(m(!0),R({topicId:t,resourceId:s,resourceType:n}).then(d=>{m(!1),b(d)}).catch(console.error))},[t,s,n]);const h=d=>{m(!0),D({topicId:t,resourceId:s,resourceType:n},d).then(()=>{b(d),i(),S(t,d)}).catch(v=>{alert(v.message),console.error(v)}).finally(()=>{m(!1)})},k=["pending","learning"].includes(g),x=["pending"].includes(g),y=["done","learning"].includes(g);return l?e("button",{className:"inline-flex cursor-default items-center rounded-md border border-gray-300 bg-white p-1 px-2 text-sm text-black",children:[e("img",{alt:"Check",class:"h-4 w-4 animate-spin",src:E}),e("span",{className:"ml-2",children:"Updating Status.."})]}):w?e("div",{className:"flex items-center gap-2",children:[e("button",{"data-popup":"login-popup",className:"inline-flex items-center rounded-md bg-green-600 p-1 px-2 text-sm text-white hover:bg-green-700",onClick:i,children:[e("img",{alt:"Check",class:"w-3",src:I}),e("span",{className:"ml-2",children:"Mark as Done"})]}),e("button",{"data-popup":"login-popup",className:"inline-flex items-center rounded-md bg-[#dad1fd] p-1 px-2 text-sm text-[#0E033B] hover:bg-[#C4B6FC]",onClick:i,children:[e("img",{alt:"Learning",class:"w-4",src:T}),e("span",{className:"ml-2",children:"In Progress"})]})]}):e("div",{class:"flex items-center gap-2 rounded-md",children:[k&&e("button",{className:"inline-flex items-center rounded-md border border-green-600 bg-green-600 p-1 px-2 text-sm text-white hover:bg-green-700",onClick:()=>h("done"),children:[e("img",{alt:"Check",class:"w-3",src:I}),e("span",{className:"ml-1",children:"Done"})]}),x&&e("button",{className:"inline-flex items-center rounded-md bg-[#dad1fd] p-1 px-2 text-sm text-[#0E033B] hover:bg-[#C4B6FC]",onClick:()=>h("learning"),children:[e("img",{alt:"Learning",className:"w-4",src:T}),e("span",{className:"ml-1",children:"Doing"})]}),y&&e("button",{className:"inline-flex items-center rounded-md border border-red-600 bg-red-600 p-1 px-2 text-sm text-white hover:bg-red-700",onClick:()=>h("pending"),children:[e("img",{alt:"Check",class:"h-4",src:J}),e("span",{className:"ml-2",children:"Pending"})]})]})}function ie(){const[o,t]=a(!1),[s,n]=a(!1),[i,l]=a(""),[m,g]=a(""),b=N(()=>!P(),[]),w=$(null),[h,k]=a(""),[x,y]=a(""),[d,v]=a("roadmap"),_=()=>{const r=document.querySelector("#login-popup");if(!r)return;r.classList.remove("hidden"),r.classList.add("flex");const p=r.querySelector("[autofocus]");p&&p.focus()};if(j(w,()=>{t(!1)}),O("Escape",()=>{t(!1)}),K(({topicId:r,resourceType:p,resourceId:u})=>{if(b){_();return}C.set("Updating"),A({topicId:r,resourceId:u,resourceType:p}).then(c=>D({topicId:r,resourceId:u,resourceType:p},c?"pending":"done")).then(({done:c=[]})=>{S(r,c.includes(r)?"done":"pending")}).catch(c=>{alert(c.message),console.error(c)}).finally(()=>{C.set("")})}),z(({topicId:r,resourceType:p,resourceId:u})=>{n(!0),t(!0),F.set(!0),k(r),v(p),y(u);const c=r.replaceAll(":","/"),H=p==="roadmap"?`/${u}/${c}`:`/best-practices/${u}/${c}`;B(H,{},{headers:{Accept:"text/html"}}).then(({response:L})=>{if(!L){l("Topic not found.");return}const U=new DOMParser().parseFromString(L,"text/html")?.getElementById("main-content")?.outerHTML||"";n(!1),g(U)}).catch(L=>{l("Something went wrong. Please try again later."),n(!1)})}),!o)return null;const M=`https://github.com/kamranahmedse/developer-roadmap/tree/master/src/data/${d==="roadmap"?"roadmaps":"best-practices"}/${x}/content`;return e("div",{children:[e("div",{ref:w,className:"fixed right-0 top-0 z-40 h-screen w-full overflow-y-auto bg-white p-4 sm:max-w-[600px] sm:p-6",children:[s&&e("div",{className:"flex w-full justify-center",children:e("img",{src:E,alt:"Loading",className:"h-6 w-6 animate-spin fill-blue-600 text-gray-200 sm:h-12 sm:w-12"})}),!s&&!i&&e(G,{children:[e("div",{className:"mb-2",children:[e(Q,{topicId:h,resourceId:x,resourceType:d,onClose:()=>{t(!1)}}),e("button",{type:"button",id:"close-topic",className:"absolute right-2.5 top-2.5 inline-flex items-center rounded-lg bg-transparent p-1.5 text-sm text-gray-400 hover:bg-gray-200 hover:text-gray-900",onClick:()=>t(!1),children:e("img",{alt:"Close",class:"h-5 w-5",src:q})})]}),e("div",{id:"topic-content",className:"prose prose-quoteless prose-h1:mb-2.5 prose-h1:mt-7 prose-h2:mb-3 prose-h2:mt-0 prose-h3:mb-[5px] prose-h3:mt-[10px] prose-p:mb-2 prose-p:mt-0 prose-blockquote:font-normal prose-blockquote:not-italic prose-blockquote:text-gray-700 prose-li:m-0 prose-li:mb-0.5",dangerouslySetInnerHTML:{__html:m}}),e("p",{id:"contrib-meta",class:"mt-10 border-t pt-3 text-sm leading-relaxed text-gray-400",children:["Contribute links to learning resources about this topic"," ",e("a",{target:"_blank",class:"text-blue-700 underline",href:M,children:"on GitHub repository."}),"."]})]})]}),e("div",{class:"fixed inset-0 z-30 bg-gray-900 bg-opacity-50 dark:bg-opacity-80"})]})}export{ie as TopicDetail};
