import{p as b,h as a,F as M,_ as O}from"./hooks.module.ee390651.js";import{C as G}from"./close.3a539829.js";import{S as N}from"./spinner.164b1eeb.js";import{a as z}from"./http.1ee0e3a2.js";import{i as j}from"./jwt.2bcbdb7f.js";import{g as K,u as I,r as T,i as J}from"./resource-progress.77080f5b.js";import{p as E,s as Q}from"./page.d4f83d9f.js";import{o as e}from"./jsxRuntime.module.760e3403.js";import{_ as P}from"./preact.module.e54f245b.js";const y="/_astro/check.46a63738.svg",S="/_astro/progress.c7872cfb.svg",_="/_astro/reset.c24545cf.svg";function V(i,t){b(()=>{const r=n=>{n.key.toLowerCase()===i.toLowerCase()&&t()};return window.addEventListener("keydown",r),()=>{window.removeEventListener("keydown",r)}},[])}function W(i){b(()=>{function t(r){const{resourceType:n,resourceId:l,topicId:d}=r.detail;i({resourceType:n,resourceId:l,topicId:d})}return window.addEventListener("roadmap.topic.click",t),window.addEventListener("best-practice.topic.click",t),()=>{window.removeEventListener("roadmap.topic.click",t),window.removeEventListener("best-practice.topic.click",t)}},[])}function X(i,t){b(()=>{const r=n=>{!i?.current?.contains(n.target)&&t()};return document.addEventListener("mousedown",r),document.addEventListener("touchstart",r),()=>{document.removeEventListener("mousedown",r),document.removeEventListener("touchstart",r)}},[i])}function Y(i){b(()=>{function t(r){const{resourceType:n,resourceId:l,topicId:d}=r.detail;i({resourceType:n,resourceId:l,topicId:d})}return window.addEventListener("best-practice.topic.toggle",t),()=>{window.removeEventListener("best-practice.topic.toggle",t)}},[])}function de(){const[i,t]=a(!1),[r,n]=a(!1),[l,d]=a(""),[D,H]=a(""),[w,C]=a("pending"),[f,x]=a(!0),v=M(()=>!j(),[]),L=O(null),[m,U]=a(""),[u,$]=a(""),[g,q]=a("roadmap"),R=()=>{const s=document.querySelector("#login-popup");if(!s)return;s.classList.remove("hidden"),s.classList.add("flex");const o=s.querySelector("[autofocus]");o&&o.focus()},h=s=>{x(!0),I({topicId:m,resourceId:u,resourceType:g},s).then(()=>{C(s),t(!1),T(m,s)}).catch(o=>{alert(o.message),console.error(o)}).finally(()=>{x(!1)})};if(b(()=>{!m||!u||!g||(x(!0),K({topicId:m,resourceId:u,resourceType:g}).then(s=>{x(!1),C(s)}).catch(console.error))},[m,u,g]),X(L,()=>{t(!1)}),V("Escape",()=>{t(!1)}),Y(({topicId:s,resourceType:o,resourceId:p})=>{if(v){R();return}E.set("Updating"),J({topicId:s,resourceId:p,resourceType:o}).then(c=>I({topicId:s,resourceId:p,resourceType:o},c?"pending":"done")).then(({done:c=[]})=>{T(s,c.includes(s)?"done":"pending")}).catch(c=>{alert(c.message),console.error(c)}).finally(()=>{E.set("")})}),W(({topicId:s,resourceType:o,resourceId:p})=>{n(!0),t(!0),Q.set(!0),U(s),q(o),$(p);const c=s.replaceAll(":","/"),A=o==="roadmap"?`/${p}/${c}`:`/best-practices/${p}/${c}`;z(A,{},{headers:{Accept:"text/html"}}).then(({response:k})=>{if(!k){d("Topic not found.");return}const F=new DOMParser().parseFromString(k,"text/html")?.getElementById("main-content")?.outerHTML||"";n(!1),H(F)}).catch(k=>{d("Something went wrong. Please try again later."),n(!1)})}),!i)return null;const B=`https://github.com/kamranahmedse/developer-roadmap/tree/master/src/data/${g==="roadmap"?"roadmaps":"best-practices"}/${u}/content`;return e("div",{children:[e("div",{ref:L,className:"fixed right-0 top-0 z-40 h-screen w-full overflow-y-auto bg-white p-4 sm:max-w-[600px] sm:p-6",children:[r&&e("div",{className:"flex w-full justify-center",children:e("img",{src:N,alt:"Loading",className:"h-6 w-6 animate-spin fill-blue-600 text-gray-200 sm:h-12 sm:w-12"})}),!r&&!l&&e(P,{children:[e("div",{className:"mb-2",children:[v&&e("div",{className:"flex items-center gap-2",children:[e("button",{"data-popup":"login-popup",className:"inline-flex items-center rounded-md bg-green-600 p-1 px-2 text-sm text-white hover:bg-green-700",onClick:()=>t(!1),children:[e("img",{alt:"Check",class:"w-3",src:y}),e("span",{className:"ml-2",children:"Done"})]}),e("button",{"data-popup":"login-popup",className:"inline-flex items-center rounded-md bg-[#dad1fd] p-1 px-2 text-sm text-[#0E033B] hover:bg-[#C4B6FC]",onClick:()=>t(!1),children:[e("img",{alt:"Learning",class:"w-4",src:S}),e("span",{className:"ml-2",children:"In Progress"})]})]}),!v&&e(P,{children:[f&&e("button",{className:"inline-flex cursor-default items-center rounded-md border border-gray-300 bg-white p-1 px-2 text-sm text-black",children:[e("img",{alt:"Check",class:"h-4 w-4 animate-spin",src:N}),e("span",{className:"ml-2",children:"Updating Status.."})]}),!f&&w==="pending"&&e("div",{className:"flex items-center gap-2",children:[e("button",{className:"inline-flex items-center rounded-md border border-green-600 bg-green-600 p-1 px-2 text-sm text-white hover:bg-green-700",onClick:()=>h("done"),children:[e("img",{alt:"Check",class:"w-3",src:y}),e("span",{className:"ml-2",children:"Done"})]}),e("button",{className:"inline-flex items-center rounded-md bg-[#dad1fd] p-1 px-2 text-sm text-[#0E033B] hover:bg-[#C4B6FC]",onClick:()=>h("learning"),children:[e("img",{alt:"Learning",class:"w-4",src:S}),e("span",{className:"ml-2",children:"In Progress"})]})]}),!f&&w==="done"&&e("button",{className:"inline-flex items-center rounded-md border border-red-600 bg-red-600 p-1 px-2 text-sm text-white hover:bg-red-700",onClick:()=>h("pending"),children:[e("img",{alt:"Check",class:"h-4",src:_}),e("span",{className:"ml-2",children:"Pending"})]}),!f&&w==="learning"&&e("div",{className:"flex items-center gap-2",children:[e("button",{className:"inline-flex items-center rounded-md border border-green-600 bg-green-600 p-1 px-2 text-sm text-white hover:bg-green-700",onClick:()=>h("done"),children:[e("img",{alt:"Check",class:"w-3",src:y}),e("span",{className:"ml-2",children:"Done"})]}),e("button",{className:"inline-flex items-center rounded-md border border-red-600 bg-red-600 p-1 px-2 text-sm text-white hover:bg-red-700",onClick:()=>h("pending"),children:[e("img",{alt:"Check",class:"h-4",src:_}),e("span",{className:"ml-2",children:"Pending"})]})]})]}),e("button",{type:"button",id:"close-topic",className:"absolute right-2.5 top-2.5 inline-flex items-center rounded-lg bg-transparent p-1.5 text-sm text-gray-400 hover:bg-gray-200 hover:text-gray-900",onClick:()=>t(!1),children:e("img",{alt:"Close",class:"h-5 w-5",src:G})})]}),e("div",{id:"topic-content",className:"prose prose-quoteless prose-h1:mb-2.5 prose-h1:mt-7 prose-h2:mb-3 prose-h2:mt-0 prose-h3:mb-[5px] prose-h3:mt-[10px] prose-p:mb-2 prose-p:mt-0 prose-blockquote:font-normal prose-blockquote:not-italic prose-blockquote:text-gray-700 prose-li:m-0 prose-li:mb-0.5",dangerouslySetInnerHTML:{__html:D}}),e("p",{id:"contrib-meta",class:"mt-10 border-t pt-3 text-sm text-gray-400 leading-relaxed",children:["Contribute links to learning resources about this topic"," ",e("a",{target:"_blank",class:"text-blue-700 underline",href:B,children:"on GitHub repository."}),"."]})]})]}),e("div",{class:"fixed inset-0 z-30 bg-gray-900 bg-opacity-50 dark:bg-opacity-80"})]})}export{de as TopicDetail};
