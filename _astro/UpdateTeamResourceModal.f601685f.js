import{_ as x,h as p,p as y}from"./hooks.module.7cc4e70a.js";import{D as L}from"./index.es.ebad3893.js";import{S as k}from"./Spinner.95905af5.js";import{c as $}from"./http.ae6f811c.js";import{r as f}from"./resource-progress.7a8a770c.js";/* empty css                       */import{u as D}from"./use-outside-click.85d1a62f.js";import{u as P}from"./use-keydown.41d75069.js";import{u as z}from"./use-toast.fb52de5d.js";import{o as e}from"./jsxRuntime.module.afbf92fe.js";function H(C){const{defaultRemovedItems:I=[],resourceId:a,resourceType:c,teamId:d,setTeamResourceConfig:E,onClose:n}=C,m=x(null),h=x(null),g=z(),[N,R]=p(!0),[j,v]=p(!1),[o,b]=p(I);y(()=>{function r(s){const i=s.target.closest(".clickable-group")?.dataset?.groupId;if(!i)return;const t=i.replace(/^\d+-/,"");o.includes(t)?(b(u=>u.filter(U=>U!==t)),f(t,"reset")):(b(u=>[...u,t]),f(t,"removed"))}return document.addEventListener("click",r),()=>{document.removeEventListener("click",r)}},[o]);let l="https://roadmap.sh";c==="roadmap"?l+=`/${a}.json`:l+=`/best-practices/${a}.json`;async function S(r){const w=await(await fetch(r)).json(),i=await L(w,{fontURL:"/fonts/balsamiq.woff2"});m.current?.replaceChildren(i),o.forEach(t=>{f(t,"removed")})}P("Escape",()=>{n()}),D(h,()=>{n()});async function T(){if(o.length===0)return;v(!0);const{error:r,response:s}=await $(`https://api.roadmap.sh/v1-update-team-resource-config/${d}`,{teamId:d,resourceId:a,resourceType:c,removed:o});if(r||!s){g.error(r?.message||"Error adding roadmap");return}E(s),n()}return y(()=>{!m.current||!l||!a||!c||!d||S(l).catch(r=>{console.error(r),g.error("Something went wrong. Please try again!")}).finally(()=>{R(!1)})},[]),e("div",{class:"fixed left-0 right-0 top-0 z-50 h-full items-center justify-center overflow-y-auto overflow-x-hidden overscroll-contain bg-black/50",children:e("div",{class:"relative mx-auto h-full w-full max-w-4xl p-4 md:h-auto",children:e("div",{ref:h,class:"popup-body relative rounded-lg bg-white shadow",children:[e("div",{className:"sticky top-0 mb-3 rounded-2xl border-4 border-white bg-black p-4",children:[e("p",{className:"mb-2 text-gray-300",children:"Click and select the items to remove from the roadmap."}),e("div",{className:"flex flex-row items-center gap-1.5",children:[e("button",{disabled:o.length===0,onClick:()=>T().finally(()=>v(!1)),className:"rounded-md bg-blue-600 px-2.5 py-1.5 text-sm text-white hover:bg-blue-700 disabled:cursor-not-allowed disabled:bg-blue-400",children:j?e("span",{className:"flex items-center gap-1.5",children:[e(k,{className:"h-3 w-3",innerFill:"white",isDualRing:!1})," ","Saving .."]}):"Save Changes"}),e("button",{onClick:n,className:"rounded-md bg-gray-600 px-2.5 py-1.5 text-sm text-white hover:bg-gray-700",children:"Cancel"})]})]}),e("div",{ref:m,className:"px-4"}),N&&e("div",{class:"flex w-full justify-center",children:e(k,{isDualRing:!1,className:"mb-4 mt-2 h-4 w-4 animate-spin fill-blue-600 text-gray-200 sm:h-8 sm:w-8"})})]})})})}export{H as U};
