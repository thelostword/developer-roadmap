import{j as e}from"./jsx-runtime.391947bd.js";import{r as l}from"./index.ed373d49.js";import{C as m}from"./CheckIcon.5f09e048.js";import{a as g}from"./http.82ebf0f1.js";import{MarkFavorite as v}from"./MarkFavorite.8da02fb5.js";import{S as y}from"./Spinner.cc2f813e.js";import{i as j}from"./jwt.f0e0aa9c.js";import"./popup.a359f713.js";import"./use-toast.fb52de5d.js";import"./toast.1fe7142d.js";import"./index.a98c85f5.js";function b(i){const{title:s="Start learning ..",message:r="Your progress and favorite roadmaps will show up here."}=i;return e.jsxs("div",{className:"relative flex min-h-full flex-col items-start sm:items-center justify-center py-6",children:[e.jsxs("h2",{className:"mb-1 flex items-center text-lg sm:text-2xl text-gray-200",children:[e.jsx(m,{additionalClasses:"mr-2 top-[0.5px] w-[16px] h-[16px] sm:w-[20px] sm:h-[20px]"}),"Start learning .."]}),e.jsx("p",{className:"text-gray-400 text-sm sm:text-base",children:r})]})}function w(i){const{progress:s,isLoading:r=!1}=i;return e.jsxs("div",{className:"relative pb-12 pt-4 sm:pt-7",children:[e.jsxs("p",{className:"mb-4 flex items-center text-sm text-gray-400",children:[!r&&e.jsx(m,{additionalClasses:"mr-1.5 w-[14px] h-[14px]"}),r&&e.jsx("span",{className:"mr-1.5",children:e.jsx(y,{})}),"Your progress and favorite roadmaps."]}),e.jsx("div",{className:"grid grid-cols-1 gap-2 sm:grid-cols-2 md:grid-cols-3",children:s.map(t=>{const n=t.resourceType==="roadmap"?`/${t.resourceId}`:`/best-practices/${t.resourceId}`,a=(t.skipped+t.done)/t.total*100;return e.jsxs("a",{href:n,className:"relative flex flex-col overflow-hidden rounded-md border border-slate-800 bg-slate-900 p-3 text-sm text-slate-400 hover:border-slate-600 hover:text-slate-300",children:[e.jsx("span",{className:"relative z-20",children:t.resourceTitle}),e.jsx("span",{className:"absolute bottom-0 left-0 top-0 z-10 bg-[#172a3a]",style:{width:`${a}%`}}),e.jsx(v,{resourceId:t.resourceId,resourceType:t.resourceType,favorite:t.isFavorite})]},t.resourceId)})})]})}function I(i){i.forEach(s=>{const r=s.resourceType==="best-practice"?`/best-practices/${s.resourceId}`:`/${s.resourceId}`,t=document.querySelector(`a[href="${r}"]`);if(!t)return;window.dispatchEvent(new CustomEvent("mark-favorite",{detail:{resourceId:s.resourceId,resourceType:s.resourceType,isFavorite:s.isFavorite}}));const a=(s.done+s.skipped)/s.total*100,c=t.querySelector("[data-progress]");c&&(c.style.width=`${a}%`)})}function q(){if(!j())return null;const[s,r]=l.useState(!0),[t,n]=l.useState(!0),[a,c]=l.useState([]),[p,u]=l.useState(0);function f(){const o=document.getElementById("hero-text");o&&(o.classList.add("opacity-0"),setTimeout(()=>{o.parentElement?.removeChild(o),r(!1),setTimeout(()=>{u(100)},50)},0))}async function d(){n(!0);const{response:o,error:h}=await g("https://api.roadmap.sh/v1-get-user-all-progress");h||!o||(c(o),n(!1),f(),I(o))}if(l.useEffect(()=>{d().finally(()=>{n(!1)})},[]),l.useEffect(()=>(window.addEventListener("refresh-favorites",d),()=>window.removeEventListener("refresh-favorites",d)),[]),s)return null;const x=a.length>0;return e.jsx("div",{className:`flex min-h-[192px] bg-gradient-to-b transition-opacity duration-500 sm:min-h-[280px] opacity-${p} ${x&&"border-t border-t-[#1e293c]"}`,children:e.jsxs("div",{className:"container min-h-full",children:[!t&&a.length==0&&e.jsx(b,{}),a.length>0&&e.jsx(w,{progress:a,isLoading:t})]})})}export{q as FavoriteRoadmaps};
