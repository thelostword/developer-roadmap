import{_ as N,h as p,p as y}from"./hooks.module.7cc4e70a.js";import{D as U}from"./index.es.ebad3893.js";import{S as T}from"./Spinner.95905af5.js";import{d as j}from"./http.82ebf0f1.js";import{a as R}from"./resource-progress.b09662c1.js";/* empty css                       */import{u as $}from"./use-outside-click.85d1a62f.js";import{u as A}from"./use-keydown.41d75069.js";import{u as z}from"./use-toast.fb52de5d.js";import{o as r}from"./jsxRuntime.module.afbf92fe.js";import{k as O}from"./preact.module.7b19fc78.js";function V(l){const{defaultRemovedItems:k=[],resourceId:h,resourceType:v,teamId:b,setTeamResourceConfig:w,onClose:c}=l,i=N(null),o=N(null),d=z(),[u,g]=p(!0),[m,n]=p(!1),[s,t]=p(k);y(()=>{function a(x){const C=x.target.closest(".clickable-group")?.dataset?.groupId;if(!C)return;const f=C.replace(/^\d+-/,"");s.includes(f)?(t(I=>I.filter(D=>D!==f)),R(f,"reset")):(t(I=>[...I,f]),R(f,"removed"))}return document.addEventListener("click",a),()=>{document.removeEventListener("click",a)}},[s]);let e="https://roadmap.sh";v==="roadmap"?e+=`/${h}.json`:e+=`/best-practices/${h}.json`;async function E(a){const S=await(await fetch(a)).json(),C=await U(S,{fontURL:"/fonts/balsamiq.woff2"});i.current?.replaceChildren(C),s.forEach(f=>{R(f,"removed")})}A("Escape",()=>{c()}),$(o,()=>{c()});async function L(){if(s.length===0)return;n(!0);const{error:a,response:x}=await j(`https://api.roadmap.sh/v1-update-team-resource-config/${b}`,{teamId:b,resourceId:h,resourceType:v,removed:s});if(a||!x){d.error(a?.message||"Error adding roadmap");return}w(x),c()}return y(()=>{!i.current||!e||!h||!v||!b||E(e).catch(a=>{console.error(a),d.error("Something went wrong. Please try again!")}).finally(()=>{g(!1)})},[]),r("div",{class:"fixed left-0 right-0 top-0 z-50 h-full items-center justify-center overflow-y-auto overflow-x-hidden overscroll-contain bg-black/50",children:r("div",{class:"relative mx-auto h-full w-full max-w-4xl p-4 md:h-auto",children:r("div",{ref:o,class:"popup-body relative rounded-lg bg-white shadow",children:[r("div",{className:"sticky top-0 mb-3 rounded-2xl border-4 border-white bg-black p-4",children:[r("p",{className:"mb-2 text-gray-300",children:"Click and select the items to remove from the roadmap."}),r("div",{className:"flex flex-row items-center gap-1.5",children:[r("button",{disabled:s.length===0,onClick:()=>L().finally(()=>n(!1)),className:"rounded-md bg-blue-600 px-2.5 py-1.5 text-sm text-white hover:bg-blue-700 disabled:cursor-not-allowed disabled:bg-blue-400",children:m?r("span",{className:"flex items-center gap-1.5",children:[r(T,{className:"h-3 w-3",innerFill:"white",isDualRing:!1})," ","Saving .."]}):"Save Changes"}),r("button",{onClick:c,className:"rounded-md bg-gray-600 px-2.5 py-1.5 text-sm text-white hover:bg-gray-700",children:"Cancel"})]})]}),r("div",{ref:i,className:"px-4"}),u&&r("div",{class:"flex w-full justify-center",children:r(T,{isDualRing:!1,className:"mb-4 mt-2 h-4 w-4 animate-spin fill-blue-600 text-gray-200 sm:h-8 sm:w-8"})})]})})})}function W({options:l,onSelect:k,inputClassName:h,searchInputId:v,placeholder:b}){const w=N(null),c=N(null),[i,o]=p(!1),[d,u]=p([]),[g,m]=p(""),[n,s]=p(0);return y(()=>{if(g.length===0){u(l.slice(0,5));return}o(!0);const t=g.trim().toLowerCase(),e=l.filter(E=>E.label.toLowerCase().indexOf(t)!==-1).slice(0,5);u(e),s(0)},[g]),y(()=>{u(l.slice(0,5))},[l]),y(()=>{if(i){const t=e=>{c.current&&!c.current.contains(e.target)&&w.current&&!w.current.contains(e.target)&&(o(!1),m(""),u(l.slice(0,5)))};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}}},[i]),r("div",{className:"relative",children:[r("input",{ref:w,type:"text",id:v,value:g,className:`w-full ${h}`,placeholder:b,autoComplete:"off",onInput:t=>{const e=t.target.value.trim();m(e)},onFocus:()=>{o(!0),u(l.slice(0,5))},onKeyDown:t=>{if(t.key==="ArrowDown"){const e=n<d.length-1;s(e?n+1:0)}else if(t.key==="ArrowUp"){const e=n>0;s(e?n-1:d.length-1)}else if(t.key==="Tab")i&&t.preventDefault();else if(t.key==="Escape")m(""),o(!1);else if(t.key==="Enter"){t.preventDefault();const e=d[n];e&&(k(e),m(""),o(!1))}}}),i&&r("div",{class:"absolute top-full z-50 mt-2 w-full rounded-md bg-gray-100 px-2 py-2",ref:c,children:r("div",{className:"flex flex-col",children:[d.length===0&&r("div",{class:"p-5 text-center text-sm text-gray-400",children:"No results found"}),d.map((t,e)=>r(O,{children:r("button",{type:"button",class:`flex w-full items-center rounded p-2 text-sm ${e===n?"bg-gray-200":""}`,onMouseOver:()=>s(e),onClick:()=>{k(t),m(""),o(!1)},children:t.label})}))]})})]})}export{W as S,V as U};
