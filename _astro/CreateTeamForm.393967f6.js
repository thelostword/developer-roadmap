import{h as u,_,p as T}from"./hooks.module.7cc4e70a.js";import{C as A}from"./CheckIcon.ecb36f9c.js";import{o as e}from"./jsxRuntime.module.afbf92fe.js";import{k as $}from"./preact.module.7b19fc78.js";import{B as j}from"./building.0debfcad.js";import{c as U,h as P,a as L}from"./http.ae6f811c.js";import{S as H}from"./Spinner.95905af5.js";import{p as R}from"./page.c1a8a472.js";import{U as D}from"./UpdateTeamResourceModal.f601685f.js";import{u as q}from"./use-keydown.41d75069.js";import{u as G}from"./use-outside-click.85d1a62f.js";import{C as V}from"./close.3a539829.js";import{g as Y,s as I}from"./browser.bcc09af3.js";import{R as F}from"./RoleDropdown.0bcc7fe3.js";import{u as O}from"./use-toast.fb52de5d.js";import"./jwt.f0e0aa9c.js";import"./index.a98c85f5.js";import"./index.es.ebad3893.js";import"./resource-progress.7a8a770c.js";/* empty css                       */import"./toast.1fe7142d.js";function W(m){const{steps:t,activeIndex:r=0,completeSteps:a=[]}=m;return e("ol",{className:"flex w-full items-center text-gray-500",children:t.map((f,h)=>{const g=a.includes(h),c=r===h,n=h===t.length-1;return e($,{children:[e("li",{className:`flex items-center ${g||c?"text-black":"text-gray-400"}`,children:[g&&e(A,{additionalClasses:"mr-2 top-[0.5px] w-[18px] h-[18px]"}),!g&&e("span",{class:"mr-2 font-semibold",children:h+1}),e("span",{className:"flex flex-grow",children:f.label})]}),!n&&e("li",{className:"mx-5 flex flex-grow rounded-md bg-gray-200",children:e("span",{className:"h-1 w-full"})})]})})})}const K="/_astro/users.1dd5ca56.svg";function B(m){const{isLoading:t=!1,text:r="Next Step",type:a="button",loadingMessage:f="Please wait ..",onClick:h=()=>null,hasNextArrow:g=!0}=m;return e("button",{type:a,onClick:h,disabled:t,className:"rounded-md border border-black bg-black px-4 py-2 text-white disabled:opacity-50",children:t?e("span",{className:"flex items-center justify-center",children:[e(H,{}),e("span",{className:"ml-2",children:f})]}):e($,{children:[r,g&&e("span",{className:"ml-1",children:"→"})]})})}const J=[{value:"company",label:"Company",icon:j,description:"Track the skills and learning progress of the tech team at your company"},{value:"study_group",label:"Study Group",icon:K,description:"Invite your friends or course-mates and track your learning progress together"}];function Q(m){const{team:t,selectedTeamType:r,onStepComplete:a,setSelectedTeamType:f}=m,[h,g]=u(!1),[c,n]=u();async function p(){if(!t){a();return}g(!0),n("");const{response:i,error:y}=await U(`https://api.roadmap.sh/v1-update-team/${t._id}`,{name:t.name,website:t?.links?.website||void 0,type:r,gitHubUrl:t?.links?.github||void 0,...r==="company"&&{teamSize:t.teamSize,linkedInUrl:t?.links?.linkedIn||void 0}});if(y||!i){g(!1),n(y?.message||"Something went wrong");return}g(!1),n(""),a()}return e($,{children:[e("div",{className:"flex flex-row gap-3",children:J.map(i=>e("button",{className:`flex flex-grow flex-col items-center rounded-lg border px-5 py-12 ${i.value==r?"border-gray-400 bg-gray-100":"border-gray-300 hover:border-gray-400 hover:bg-gray-50"}`,onClick:()=>f(i.value),children:[e("img",{alt:i.label,src:i.icon,className:`mb-3 h-12 w-12 opacity-10 ${i.value===r?"opacity-100":""}`}),e("span",{className:"mb-2 block text-2xl font-bold",children:i.label}),e("span",{className:"text-sm text-gray-500 leading-[21px]",children:i.description})]}))}),c&&e("div",{className:"mt-4 text-sm text-red-500",children:c}),e("div",{className:"mt-4 flex flex-row items-center justify-between gap-2",children:[e("a",{href:"/account",className:"rounded-md border border-red-400 bg-white px-8 py-2 text-red-500",children:"Cancel"}),e(B,{type:"button",onClick:p,isLoading:h,text:"Next Step",loadingMessage:"Updating team .."})]})]})}const X=["1-5","6-10","11-25","26-50","51-100","101-200","201-500","501-1000","1000+"];function Z(m){const{team:t,selectedTeamType:r,onBack:a,onStepComplete:f}=m,[h,g]=u(""),c=_(null);T(()=>{c.current&&c.current.focus()},[c]);const[n,p]=u(!1),[i,y]=u(t?.name||""),[v,N]=u(t?.links?.website||""),[s,x]=u(t?.links?.linkedIn||""),[l,d]=u(t?.links?.github||""),[o,w]=u(t?.teamSize||"");return e("form",{onSubmit:async b=>{if(b.preventDefault(),p(!0),!i||!r){p(!1);return}let S,C;if(t?._id){if({response:S,error:C}=await U(`https://api.roadmap.sh/v1-update-team/${t._id}`,{name:i,website:v||void 0,type:r,gitHubUrl:l||void 0,...r==="company"&&{teamSize:o,linkedInUrl:s||void 0}}),C||S?.status!=="ok"){g(C?.message||"Something went wrong. Please try again."),p(!1);return}f({...t,name:i,_id:t._id,links:{website:v||t?.links?.website,linkedIn:s||t?.links?.linkedIn,github:l||t?.links?.github},type:r,teamSize:o})}else{if({response:S,error:C}=await P("https://api.roadmap.sh/v1-create-team",{name:i,website:v||void 0,type:r,gitHubUrl:l||void 0,...r==="company"&&{teamSize:o,linkedInUrl:s||void 0},roadmapIds:[],bestPracticeIds:[]}),C||!S?._id){g(C?.message||"Something went wrong. Please try again."),p(!1);return}f(S)}},children:[e("div",{className:"flex w-full flex-col",children:[e("label",{for:"name",className:'text-sm leading-none text-slate-500 after:text-red-400 after:content-["*"]',children:r==="company"?"Company Name":"Group Name"}),e("input",{type:"text",name:"name",ref:c,autofocus:!0,id:"name",className:"mt-2 block w-full rounded-lg border border-gray-300 px-3 py-2 shadow-sm outline-none placeholder:text-gray-400 focus:ring-2 focus:ring-black focus:ring-offset-1",placeholder:"Roadmap Inc.",disabled:n,required:!0,value:i,onInput:b=>y(b.target.value)})]}),r==="company"&&e("div",{className:"mt-4 flex w-full flex-col",children:[e("label",{for:"website",className:'text-sm leading-none text-slate-500 after:text-red-400 after:content-["*"]',children:"Website"}),e("input",{type:"url",name:"website",required:!0,id:"website",className:"mt-2 block w-full rounded-lg border border-gray-300 px-3 py-2 shadow-sm outline-none placeholder:text-gray-400 focus:ring-2 focus:ring-black focus:ring-offset-1",placeholder:"https://roadmap.sh",disabled:n,value:v,onInput:b=>N(b.target.value)})]}),r==="company"&&e("div",{className:"mt-4 flex w-full flex-col",children:[e("label",{for:"website",className:"text-sm leading-none text-slate-500",children:"Company LinkedIn URL"}),e("input",{type:"url",name:"website",id:"website",className:"mt-2 block w-full rounded-lg border border-gray-300 px-3 py-2 shadow-sm outline-none placeholder:text-gray-400 focus:ring-2 focus:ring-black focus:ring-offset-1",placeholder:"https://www.linkedin.com/company/roadmapsh",disabled:n,value:s,onInput:b=>x(b.target.value)})]}),e("div",{className:"mt-4 flex w-full flex-col",children:[e("label",{for:"website",className:"text-sm leading-none text-slate-500",children:"GitHub Organization URL"}),e("input",{type:"url",name:"website",id:"website",className:"mt-2 block w-full rounded-lg border border-gray-300 px-3 py-2 shadow-sm outline-none placeholder:text-gray-400 focus:ring-2 focus:ring-black focus:ring-offset-1",placeholder:"https://github.com/roadmapsh",disabled:n,value:l,onInput:b=>d(b.target.value)})]}),r==="company"&&e("div",{className:"mt-4 flex w-full flex-col",children:[e("label",{for:"team-size",className:'text-sm leading-none text-slate-500 after:text-red-400 after:content-["*"]',children:"Tech Team Size"}),e("select",{name:"team-size",id:"team-size",className:"mt-2 block w-full rounded-lg border border-gray-300 px-3 py-2 shadow-sm outline-none placeholder:text-gray-400 focus:ring-2 focus:ring-black focus:ring-offset-1",required:r==="company",disabled:n,value:o,onChange:b=>w(b.target.value),children:[e("option",{value:"",selected:!0,children:"Select team size"}),X.map(b=>e("option",{value:b,children:[b," people"]}))]})]}),h&&e("div",{className:"mt-4 flex w-full flex-col",children:e("span",{className:"text-sm text-red-500",children:h})}),e("div",{className:"mt-4 flex flex-row items-center justify-between gap-2",children:[e("button",{type:"button",onClick:a,className:"rounded-md border border-red-400 bg-white px-4 py-2 text-red-500",children:[e("span",{className:"mr-1",children:"←"}),"Previous Step"]}),e(B,{isLoading:n,text:"Next Step",type:"submit",loadingMessage:"Creating team .."})]})]})}const ee="/_astro/chevron-down.d226c7e9.svg";function z(m){const{isSelected:t,onClick:r,title:a}=m;return e("button",{className:`group flex min-h-[35px] items-stretch overflow-hidden rounded-md text-sm ${t?"bg-black text-white transition-colors hover:bg-gray-700":"border border-gray-300 hover:bg-gray-100"}`,onClick:r,children:[e("span",{className:"flex items-center px-3",children:a}),t&&e("span",{className:"flex items-center bg-gray-700 px-3 text-xs text-white transition-colors",children:"×"}),!t&&e("span",{className:"flex items-center bg-gray-100 px-2.5 text-xs text-gray-500",children:"+"})]})}function te(m){const{onClose:t,allRoadmaps:r,onRoadmapAdd:a,onRoadmapRemove:f,teamResourceConfig:h}=m,g=_(null),c=_(null),[n,p]=u(r),[i,y]=u("");q("Escape",()=>{t()}),G(g,()=>{t()}),T(()=>{c.current&&c.current.focus()},[c]),T(()=>{if(i.length===0){p(r);return}const s=r.filter(x=>x.title.toLowerCase().includes(i.toLowerCase())||x.id.toLowerCase().includes(i.toLowerCase()));p(s)},[i,r]);const v=n.filter(s=>s?.metadata?.tags?.includes("role-roadmap")),N=n.filter(s=>s?.metadata?.tags?.includes("skill-roadmap"));return e("div",{class:"fixed left-0 right-0 top-0 z-50 h-full items-center justify-center overflow-y-auto overflow-x-hidden overscroll-contain bg-black/50",children:e("div",{class:"relative mx-auto h-full w-full max-w-2xl p-4 md:h-auto",children:e("div",{ref:g,class:"popup-body relative mt-4 overflow-hidden rounded-lg bg-white shadow",children:[e("button",{type:"button",className:"popup-close absolute right-2.5 top-3 ml-auto inline-flex items-center rounded-lg bg-transparent p-1.5 text-sm text-gray-400 hover:bg-gray-100 hover:text-gray-900",onClick:t,children:[e("img",{alt:"close",src:V,className:"h-4 w-4"}),e("span",{class:"sr-only",children:"Close modal"})]}),e("input",{ref:c,type:"text",placeholder:"Search roadmaps",className:"block w-full border-b px-5 pb-3.5 pt-4 outline-none placeholder:text-gray-400",value:i,onInput:s=>y(s.target.value)}),e("div",{className:"min-h-[200px] p-4",children:[e("span",{className:"block pb-3 text-xs uppercase text-gray-400",children:"Role Based Roadmaps"}),v.length===0&&e("p",{className:"mb-1 flex h-full items-start text-sm italic text-gray-400"}),v.length>0&&e("div",{className:"mb-5 flex flex-wrap items-center gap-2",children:v.map(s=>{const x=!!h.find(l=>l.resourceId===s.id);return e(z,{title:s.title,isSelected:x,onClick:()=>{x?f(s.id):a(s.id)}})})}),e("span",{className:"block pb-3 text-xs uppercase text-gray-400",children:"Skill Based Roadmaps"}),e("div",{className:"flex flex-wrap items-center gap-2",children:N.map(s=>{const x=!!h.find(l=>l.resourceId===s.id);return e(z,{title:s.title,isSelected:x,onClick:()=>{x?f(s.id):a(s.id)}})})})]})]})})})}function re(m){const{team:t,teamResourceConfig:r=[],setTeamResourceConfig:a}=m,[f,h]=u(!1),[g,c]=u([]),[n,p]=u(""),[i,y]=u("");async function v(){const{error:l,response:d}=await L("/pages.json");if(l){y(l.message||"Something went wrong. Please try again!");return}if(!d)return[];const o=d.filter(w=>w.group==="Roadmaps").sort((w,k)=>w.title==="Android"?1:w.title.localeCompare(k.title));return c(o),d}async function N(l){if(!t?._id)return;R.set("Deleting resource");const{error:d,response:o}=await U(`https://api.roadmap.sh/v1-delete-team-resource-config/${t._id}`,{resourceId:l,resourceType:"roadmap"});if(d||!o){y(d?.message||"Error deleting roadmap");return}a(o)}async function s(l){R.set("Removing roadmap"),N(l).finally(()=>{R.set("")})}async function x(l){if(!t?._id)return;R.set("Adding roadmap to team");const{error:d,response:o}=await U(`https://api.roadmap.sh/v1-update-team-resource-config/${t._id}`,{teamId:t._id,resourceId:l,resourceType:"roadmap",removed:[]});if(d||!o){y(d?.message||"Error adding roadmap");return}a(o)}return T(()=>{v().finally()},[]),e("div",{children:[n&&e(D,{onClose:()=>p(""),resourceId:n,resourceType:"roadmap",teamId:t?._id,setTeamResourceConfig:a,defaultRemovedItems:r.find(l=>l.resourceId===n)?.removed||[]}),f&&e(te,{onClose:()=>h(!1),teamResourceConfig:r,allRoadmaps:g,teamId:t?._id,onRoadmapAdd:l=>{x(l).finally(()=>{R.set("")})},onRoadmapRemove:l=>{s(l).finally(()=>{})}}),e("div",{className:"mt-3 flex cursor-text items-center justify-between rounded-md border border-gray-300 px-3 py-2.5 hover:border-gray-400/50 hover:bg-gray-50",role:"button",onClick:()=>{h(!0)},children:[r.length>0&&e("div",{className:"flex flex-col",children:[e("p",{className:"mb-1.5 text-base font-medium text-gray-800",children:[r.length," roadmaps selected"]}),e("p",{className:"text-sm text-gray-400",children:"Click to add or change selection"})]}),!r.length&&e("div",{className:"flex flex-col",children:e("p",{className:"text-base text-gray-400",children:"Click to select roadmaps"})}),e("img",{alt:"roadmap",src:ee,className:"relative top-[1px] h-[17px] w-[17px] opacity-40"})]}),!r.length&&e("p",{className:"mb-3 mt-2 text-base text-gray-400",children:"No roadmaps selected."}),r.length>0&&e("div",{className:"mt-4 grid grid-cols-3 flex-wrap gap-2.5",children:r.map(({resourceId:l,removed:d})=>{const o=g.find(w=>w.id===l)?.title||"...";return e("div",{className:"flex flex-col items-start rounded-md border border-gray-300",children:[e("div",{className:"w-full px-3 pb-2 pt-4",children:[e("span",{className:"mb-0.5 block text-base font-medium leading-none text-black",children:o}),d.length>0?e("span",{className:"text-xs leading-none text-gray-900",children:[d.length," topic",d.length>1?"s":""," removed"]}):e("span",{className:"text-xs italic leading-none text-gray-400/60",children:"No changes made .."})]}),e("div",{className:"flex w-full justify-between p-3",children:[e("button",{type:"button",className:"text-xs text-gray-500 underline hover:text-black focus:outline-none",onClick:()=>p(l),children:"Customize"}),e("button",{type:"button",className:"text-xs text-red-500 underline hover:text-black",onClick:()=>s(l),children:"Remove"})]})]})})})]})}function ae(m){const{team:t,onBack:r,onNext:a,teamResourceConfig:f,setTeamResourceConfig:h}=m;return e($,{children:[e("div",{className:"mt-4 flex w-full flex-col",children:[e("div",{className:"mb-1 mt-2",children:[e("h2",{className:"mb-1.5 text-2xl font-bold",children:"Select Roadmaps"}),e("p",{className:"text-sm text-gray-700",children:"You can always add and customize your roadmaps later."})]}),e(re,{team:t,teamResourceConfig:f,setTeamResourceConfig:h})]}),e("div",{className:"mt-4 flex flex-row items-center justify-between gap-2",children:[e("button",{type:"button",onClick:r,className:"rounded-md border border-red-400 bg-white px-4 py-2 text-red-500",children:[e("span",{className:"mr-1",children:"←"}),"Previous Step"]}),e("div",{className:"flex gap-2",children:[f.length===0&&e("button",{type:"button",onClick:a,className:"rounded-md border border-gray-300 bg-white px-4 py-2 text-gray-500 hover:border-gray-400 hover:text-black",children:"Skip for Now"}),e("button",{type:"submit",disabled:f.length===0,onClick:a,className:"rounded-md border bg-black px-4 py-2 text-white disabled:opacity-50",children:["Next Step",e("span",{className:"ml-1",children:"→"})]})]})]})]})}function se(m){const{className:t=""}=m;return e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",className:t,children:[e("path",{d:"M3 6h18"}),e("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),e("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"}),e("line",{x1:"10",x2:"10",y1:"11",y2:"17"}),e("line",{x1:"14",x2:"14",y1:"11",y2:"17"})]})}function M(){return`${new Date().getTime()}`}function le(m){const{onNext:t,onBack:r,team:a}=m,[f,h]=u(""),[g,c]=u(!1),n=_(null),[p,i]=u([{id:M(),email:"",role:"member"}]);async function y(){c(!0);const{error:s,response:x}=await P(`https://api.roadmap.sh/v1-invite-team/${a?._id}`,{members:p});if(s||!x){h(s?.message||"Something went wrong"),c(!1);return}t()}function v(){n.current&&n.current.focus()}function N(s){s.preventDefault(),y().finally(()=>null)}return T(()=>{v()},[p.length]),e("form",{className:"mt-4 flex w-full flex-col",onSubmit:N,children:[e("div",{class:"mb-1 mt-2",children:[e("h2",{class:"mb-2 text-2xl font-bold",children:"Invite your Team"}),e("p",{class:"text-sm text-gray-700",children:"Use the form below to invite your team members to your team. You can also invite them later."})]}),e("div",{className:"mt-4 flex flex-col gap-1",children:p.map((s,x)=>e("div",{className:"flex flex-row gap-2",children:[e("input",{ref:x===p.length-1?n:null,autofocus:!0,type:"email",name:"email",required:!0,id:"email",placeholder:"Email",value:s.email,onChange:l=>{const d=p.map(o=>o.id===s.id?{...o,email:l.target?.value}:o);i(d)},className:"flex-grow rounded-md border border-gray-200 bg-white px-4 py-2 text-gray-900"}),e(F,{selectedRole:s.role,setSelectedRole:l=>{const d=p.map(o=>o.id===s.id?{...o,role:l}:o);i(d)}}),e("button",{disabled:p.length<=1,type:"button",className:"rounded-md border border-red-200 bg-white px-4 py-2 text-red-500 hover:bg-red-100 disabled:opacity-30",onClick:()=>{i(p.filter(l=>l.id!==s.id))},children:e(se,{className:"h-5 w-5"})})]},s.id))}),p.length<=30&&e("button",{onClick:()=>{i([...p,{id:M(),email:"",role:"member"}])},type:"button",className:"mt-2 rounded-md border border-dashed border-gray-400 py-2 text-sm text-gray-500 hover:border-gray-500 hover:text-gray-800",children:"+ Add another"}),f&&e("div",{className:"mt-2 text-sm font-medium text-red-500",role:"alert",children:f}),e("div",{className:"mt-4 flex flex-row items-center justify-between gap-2",children:[e("button",{type:"button",onClick:r,className:"rounded-md border border-red-400 bg-white px-4 py-2 text-red-500",children:[e("span",{className:"mr-1",children:"←"}),"Previous Step"]}),e("div",{className:"flex gap-2",children:[e("button",{type:"button",onClick:t,className:"rounded-md border border-gray-300 bg-white px-4 py-2 text-gray-500 hover:border-gray-400 hover:text-black",children:"Skip for Now"}),e(B,{type:"submit",isLoading:g,text:"Send Invites",loadingMessage:"Updating team ..",hasNextArrow:!1})]})]})]})}function ne({team:m}){return e("div",{className:"mt-4 flex flex-col rounded-xl border py-12 text-center",children:e("div",{class:"mb-1 flex flex-col items-center",children:[e(A,{additionalClasses:"h-14 w-14 mb-4 opacity-100"}),e("h2",{class:"mb-2 text-2xl font-bold",children:"Team Created"}),e("p",{class:"text-sm text-gray-700",children:"Your team has been created. Happy learning!"}),e("a",{href:`/team/progress?t=${m._id}`,class:"mt-4 rounded-md bg-black px-5 py-1.5 text-sm text-white",children:"View Team"})]})})}function _e(){const{s:m,t}=Y(),r=O(),[a,f]=u(),[h,g]=u(!!t&&!a?._id),[c,n]=u(0);async function p(o,w){const{response:k,error:b}=await L(`https://api.roadmap.sh/v1-get-team/${o}`);if(b||!k){r.error(b?.message||"Error loading team"),window.location.href="/account";return}const S=parseInt(w,10),C=Array(S).fill(1).map((oe,E)=>E);f(k),s(k.type),l(C),n(S),await v(o)}const[i,y]=u([]);async function v(o){const{error:w,response:k}=await L(`https://api.roadmap.sh/v1-get-team-resource-config/${o}`);if(w||!Array.isArray(k)){console.error(w);return}y(k)}T(()=>{!t||!m||a||(R.set("Fetching team"),g(!0),p(t,m).finally(()=>{g(!1),R.set("")}))},[t,m]);const[N,s]=u(a?.type||"company"),[x,l]=u([0]);if(h)return null;let d=null;return c===0?d=e(Q,{team:a,selectedTeamType:N,setSelectedTeamType:s,onStepComplete:()=>{a?._id&&I({t:a._id,s:"1"}),l([0]),n(1)}}):c===1?d=e(Z,{team:a,onBack:()=>{a?._id&&I({t:a._id,s:"0"}),n(0)},onStepComplete:o=>{const w=o._id;I({t:w,s:"2"}),l([0,1]),n(2),f(o)},selectedTeamType:N}):c===2?d=e(ae,{team:a,teamResourceConfig:i,setTeamResourceConfig:y,onBack:()=>{a&&I({t:a._id,s:"1"}),n(1)},onNext:()=>{I({t,s:"3"}),l([0,1,2]),n(3)}}):c===3?d=e(le,{team:a,onBack:()=>{a&&I({t:a._id,s:"2"}),n(2)},onNext:()=>{a&&I({t:a._id,s:"4"}),l([0,1,2,3]),n(4)}}):c===4&&(d=e(ne,{team:a})),e("div",{className:"mx-auto max-w-[700px] py-6",children:[e("div",{className:"mb-8 flex flex-col items-center",children:[e("h1",{className:"text-4xl font-bold",children:"Create Team"}),e("p",{className:"mt-2 text-gray-500",children:"Complete the steps below to create your team"})]}),e("div",{className:"mb-8 mt-8 flex w-full",children:e(W,{activeIndex:c,completeSteps:x,steps:[{label:"Type"},{label:"Details"},{label:"Skills"},{label:"Members"}]})}),d]})}export{_e as CreateTeamForm};
