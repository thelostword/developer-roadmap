import{p as h,h as a,F as O,_ as G}from"./hooks.module.ee390651.js";import{C as z}from"./close.3a539829.js";import{S as C}from"./spinner.164b1eeb.js";import{a as j}from"./http.1ee0e3a2.js";import{i as K}from"./jwt.2bcbdb7f.js";import{g as J,u as I,r as T,i as Q}from"./resource-progress.77080f5b.js";import{p as N,s as V}from"./page.d4f83d9f.js";import{o as e}from"./jsxRuntime.module.760e3403.js";import{_ as W}from"./preact.module.e54f245b.js";const E="/_astro/check.46a63738.svg",P="/_astro/progress.c7872cfb.svg",X="/_astro/reset.c24545cf.svg";function Y(i,t){h(()=>{const n=r=>{r.key.toLowerCase()===i.toLowerCase()&&t()};return window.addEventListener("keydown",n),()=>{window.removeEventListener("keydown",n)}},[])}function Z(i){h(()=>{function t(n){const{resourceType:r,resourceId:l,topicId:d}=n.detail;i({resourceType:r,resourceId:l,topicId:d})}return window.addEventListener("roadmap.topic.click",t),window.addEventListener("best-practice.topic.click",t),()=>{window.removeEventListener("roadmap.topic.click",t),window.removeEventListener("best-practice.topic.click",t)}},[])}function ee(i,t){h(()=>{const n=r=>{!i?.current?.contains(r.target)&&t()};return document.addEventListener("mousedown",n),document.addEventListener("touchstart",n),()=>{document.removeEventListener("mousedown",n),document.removeEventListener("touchstart",n)}},[i])}function te(i){h(()=>{function t(n){const{resourceType:r,resourceId:l,topicId:d}=n.detail;i({resourceType:r,resourceId:l,topicId:d})}return window.addEventListener("best-practice.topic.toggle",t),()=>{window.removeEventListener("best-practice.topic.toggle",t)}},[])}function ue(){const[i,t]=a(!1),[n,r]=a(!1),[l,d]=a(""),[M,S]=a(""),[w,y]=a("pending"),[f,b]=a(!0),x=O(()=>!K(),[]),L=G(null),[m,_]=a(""),[u,D]=a(""),[g,H]=a("roadmap"),U=()=>{const s=document.querySelector("#login-popup");if(!s)return;s.classList.remove("hidden"),s.classList.add("flex");const o=s.querySelector("[autofocus]");o&&o.focus()},v=s=>{b(!0),I({topicId:m,resourceId:u,resourceType:g},s).then(()=>{y(s),t(!1),T(m,s)}).catch(o=>{alert(o.message),console.error(o)}).finally(()=>{b(!1)})};if(h(()=>{!m||!u||!g||(b(!0),J({topicId:m,resourceId:u,resourceType:g}).then(s=>{b(!1),y(s)}).catch(console.error))},[m,u,g]),ee(L,()=>{t(!1)}),Y("Escape",()=>{t(!1)}),te(({topicId:s,resourceType:o,resourceId:p})=>{if(x){U();return}N.set("Updating"),Q({topicId:s,resourceId:p,resourceType:o}).then(c=>I({topicId:s,resourceId:p,resourceType:o},c?"pending":"done")).then(({done:c=[]})=>{T(s,c.includes(s)?"done":"pending")}).catch(c=>{alert(c.message),console.error(c)}).finally(()=>{N.set("")})}),Z(({topicId:s,resourceType:o,resourceId:p})=>{r(!0),t(!0),V.set(!0),_(s),H(o),D(p);const c=s.replaceAll(":","/"),A=o==="roadmap"?`/${p}/${c}`:`/best-practices/${p}/${c}`;j(A,{},{headers:{Accept:"text/html"}}).then(({response:k})=>{if(!k){d("Topic not found.");return}const F=new DOMParser().parseFromString(k,"text/html")?.getElementById("main-content")?.outerHTML||"";r(!1),S(F)}).catch(k=>{d("Something went wrong. Please try again later."),r(!1)})}),!i)return null;const $=`https://github.com/kamranahmedse/developer-roadmap/tree/master/src/data/${g==="roadmap"?"roadmaps":"best-practices"}/${u}/content`,q=["pending","learning"].includes(w),R=["pending"].includes(w),B=["done","learning"].includes(w);return e("div",{children:[e("div",{ref:L,className:"fixed right-0 top-0 z-40 h-screen w-full overflow-y-auto bg-white p-4 sm:max-w-[600px] sm:p-6",children:[n&&e("div",{className:"flex w-full justify-center",children:e("img",{src:C,alt:"Loading",className:"h-6 w-6 animate-spin fill-blue-600 text-gray-200 sm:h-12 sm:w-12"})}),!n&&!l&&e(W,{children:[e("div",{className:"mb-2",children:[x&&e("div",{className:"flex items-center gap-2",children:[e("button",{"data-popup":"login-popup",className:"inline-flex items-center rounded-md bg-green-600 p-1 px-2 text-sm text-white hover:bg-green-700",onClick:()=>t(!1),children:[e("img",{alt:"Check",class:"w-3",src:E}),e("span",{className:"ml-2",children:"Mark as Done"})]}),e("button",{"data-popup":"login-popup",className:"inline-flex items-center rounded-md bg-[#dad1fd] p-1 px-2 text-sm text-[#0E033B] hover:bg-[#C4B6FC]",onClick:()=>t(!1),children:[e("img",{alt:"Learning",class:"w-4",src:P}),e("span",{className:"ml-2",children:"In Progress"})]})]}),!x&&e("div",{class:"flex items-center gap-2 rounded-md",children:[f&&e("button",{className:"inline-flex cursor-default items-center rounded-md border border-gray-300 bg-white p-1 px-2 text-sm text-black",children:[e("img",{alt:"Check",class:"h-4 w-4 animate-spin",src:C}),e("span",{className:"ml-2",children:"Updating Status.."})]}),!f&&q&&e("button",{className:"inline-flex items-center rounded-md border border-green-600 bg-green-600 p-1 px-2 text-sm text-white hover:bg-green-700",onClick:()=>v("done"),children:[e("img",{alt:"Check",class:"w-3",src:E}),e("span",{className:"ml-2",children:"Mark as Done"})]}),!f&&R&&e("button",{className:"inline-flex items-center rounded-md bg-[#dad1fd] p-1 px-2 text-sm text-[#0E033B] hover:bg-[#C4B6FC]",onClick:()=>v("learning"),children:[e("img",{alt:"Learning",className:"w-4",src:P}),e("span",{className:"ml-2",children:"In Progress"})]}),!f&&B&&e("button",{className:"inline-flex items-center rounded-md border border-red-600 bg-red-600 p-1 px-2 text-sm text-white hover:bg-red-700",onClick:()=>v("pending"),children:[e("img",{alt:"Check",class:"h-4",src:X}),e("span",{className:"ml-2",children:"Mark as Pending"})]})]}),e("button",{type:"button",id:"close-topic",className:"absolute right-2.5 top-2.5 inline-flex items-center rounded-lg bg-transparent p-1.5 text-sm text-gray-400 hover:bg-gray-200 hover:text-gray-900",onClick:()=>t(!1),children:e("img",{alt:"Close",class:"h-5 w-5",src:z})})]}),e("div",{id:"topic-content",className:"prose prose-quoteless prose-h1:mb-2.5 prose-h1:mt-7 prose-h2:mb-3 prose-h2:mt-0 prose-h3:mb-[5px] prose-h3:mt-[10px] prose-p:mb-2 prose-p:mt-0 prose-blockquote:font-normal prose-blockquote:not-italic prose-blockquote:text-gray-700 prose-li:m-0 prose-li:mb-0.5",dangerouslySetInnerHTML:{__html:M}}),e("p",{id:"contrib-meta",class:"mt-10 border-t pt-3 text-sm leading-relaxed text-gray-400",children:["Contribute links to learning resources about this topic"," ",e("a",{target:"_blank",class:"text-blue-700 underline",href:$,children:"on GitHub repository."}),"."]})]})]}),e("div",{class:"fixed inset-0 z-30 bg-gray-900 bg-opacity-50 dark:bg-opacity-80"})]})}export{ue as TopicDetail};
